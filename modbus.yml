modules:

    # Module name, needs to be passed as parameter by Prometheus.
  - name: "fake"
    protocol: 'tcp/ip'
    metrics:
        # Name of the metric.
      - name: "power_consumption_total"
        # Help text of the metric.
        help: "represents the overall power consumption by phase"
        # Labels to be added to the time series.
        labels:
          phase: "1"
        # Register address.
        # The first digit of the address is the function code
        # Supported codes are: 1, 2, 3, 4
        address: 300022
        # Datatypes allowed: bool, int16, int32, int64, uint16, uint32, uint64,
        #   float16, float32, float64
        # One register holds 16 bits.
        dataType: int16
        # Endianness allowed: big, little, mixed, yolo
        # Optional. If not defined: big.
        endianness: big
        # Prometheus metric type: https://prometheus.io/docs/concepts/metric_types/.
        metricType: counter
        # Factor can be specified to represent metric value.
        # Examples: 1, 2, 1.543, 0.01 etc
        # Factor is multiplied with the scraped value to produce the metric value
        # Optional.
        factor: 3.1415926535

      - name: "some_gauge"
        help: "some help for some gauge"
        address: 30023
        dataType: int16
        metricType: gauge
        factor: 2

      - name: "coil"
        help: "some help for some coil"
        address: 124
        dataType: bool
        bitOffset: 0
        metricType: gauge
  - name: "carlo_gavazzi_em_et_1xx_series_rtu"
    # registers and units from https://gavazzi.se/app/uploads/2020/11/em111_em112_et112_cp.pdf (registers converted from hex to decimal)
    protocol: 'serial'
    baudrate: 57600
    databits: 8
    parity: "N"
    stopbits: 1
    timeout: 2000
    metrics: &cagaemet1xx-metrics
      - name: "cagaemet_phase_voltage_volts"
        help: "Voltage of the phase"
        labels:
          phase: "L1"
          reference: "N"
        address: 300000
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_load_amps"
        help: "Power draw on the phase in Amperes"
        labels:
          phase: "L1"
        address: 300002
        dataType: "int32"
        metricType: "gauge"
        factor: 0.001
        endianness: "yolo"
      - name: "cagaemet_phase_load_watts"
        help: "Power draw on the phase in Watts"
        labels:
          phase: "L1"
        address: 300004
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_load_va"
        help: "Power draw on the phase in Volts-Amperes"
        labels:
          phase: "L1"
        address: 300006
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_load_var"
        help: "Power draw on the phase in Volts-Amperes-Reactive"
        labels:
          phase: "L1"
        address: 300008
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_load_dmd_watts"
        help: "Power draw DMD on the meter in Watts"
        labels:
          phase: "L1"
        address: 300010
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_identification_code"
        help: "Carlo Gavazzi Controls identification code for this meter"
        address: 300011
        dataType: "uint16"
        metricType: "gauge"
      - name: "cagaemet_load_dmd_peak_watts"
        help: "Peak power draw DMD on the meter in Watts"
        labels:
          phase: "L1"
        address: 300012
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_power_factor"
        help: "Power factor of the phase"
        labels:
          phase: "L1"
        address: 300014
        dataType: "int16"
        metricType: "gauge"
        factor: 0.001
        endianness: "yolo"
      - name: "cagaemet_frequency_hertz"
        help: "Power frequency in Hertz"
        address: 300015
        dataType: "int16"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_consumed_kwh_total"
        help: "Total kwh consumed on this meter"
        address: 300016
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_consumed_kvarh_total"
        help: "Total kvarh consumed on this meter"
        address: 300018
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_produced_kwh_total"
        help: "Total kwh produced on this meter"
        address: 300032
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_produced_kvarh_total"
        help: "Total kvarh produced on this meter"
        address: 300034
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_firmware_version"
        help: "The firmware version of this meter"
        address: 300770
        dataType: "uint16"
        metricType: "gauge"
      - name: "cagaemet_firmware_revision"
        help: "The firmware revision of this meter"
        address: 300771
        dataType: "uint16"
        metricType: "gauge"
      - name: "cagaemet_modbus_address"
        help: "The Modbus address for this meter (1-247)"
        address: 308192
        dataType: "uint16"
        metricType: "gauge"
  - name: "carlo_gavazzi_em_et_1xx_series_tcp"
    protocol: 'tcp/ip'
    timeout: 2000
    metrics: *cagaemet1xx-metrics
  - name: "carlo_gavazzi_em_et_3xx_series_rtu"
    # registers and units from https://gavazzi.se/app/uploads/2020/11/em330_em340_et330_et340_cp.pdf (registers converted from hex to decimal)
    protocol: 'serial'
    baudrate: 57600
    databits: 8
    parity: "N"
    stopbits: 1
    timeout: 2000
    metrics: &cagaemet3xx-metrics
      - name: "cagaemet_phase_voltage_volts"
        help: "Voltage of the phase"
        labels:
          phase: "L1"
          reference: "N"
        address: 300000
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_voltage_volts"
        help: "Voltage of the phase"
        labels:
          phase: "L2"
          reference: "N"
        address: 300002
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_voltage_volts"
        help: "Voltage of the phase"
        labels:
          phase: "L3"
          reference: "N"
        address: 300004
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_voltage_volts"
        help: "Voltage of the phase"
        labels:
          phase: "L1"
          reference: "L2"
        address: 300006
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_voltage_volts"
        help: "Voltage of the phase"
        labels:
          phase: "L2"
          reference: "L3"
        address: 300008
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_voltage_volts"
        help: "Voltage of the phase"
        labels:
          phase: "L3"
          reference: "L1"
        address: 300010
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_identification_code"
        help: "Carlo Gavazzi Controls identification code for this meter"
        address: 300011
        dataType: "uint16"
        metricType: "gauge"
      - name: "cagaemet_phase_load_amps"
        help: "Power draw on the phase in Amperes"
        labels:
          phase: "L1"
        address: 300012
        dataType: "int32"
        metricType: "gauge"
        factor: 0.001
        endianness: "yolo"
      - name: "cagaemet_phase_load_amps"
        help: "Power draw on the phase in Amperes"
        labels:
          phase: "L2"
        address: 300014
        dataType: "int32"
        metricType: "gauge"
        factor: 0.001
        endianness: "yolo"
      - name: "cagaemet_phase_load_amps"
        help: "Power draw on the phase in Amperes"
        labels:
          phase: "L3"
        address: 300016
        dataType: "int32"
        metricType: "gauge"
        factor: 0.001
        endianness: "yolo"
      - name: "cagaemet_phase_load_watts"
        help: "Power draw on the phase in Watts"
        labels:
          phase: "L1"
        address: 300018
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_load_watts"
        help: "Power draw on the phase in Watts"
        labels:
          phase: "L2"
        address: 300020
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_load_watts"
        help: "Power draw on the phase in Watts"
        labels:
          phase: "L3"
        address: 300022
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_load_va"
        help: "Power draw on the phase in Volts-Amperes"
        labels:
          phase: "L1"
        address: 300024
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_load_va"
        help: "Power draw on the phase in Volts-Amperes"
        labels:
          phase: "L2"
        address: 300026
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_load_va"
        help: "Power draw on the phase in Volts-Amperes"
        labels:
          phase: "L3"
        address: 300028
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_load_var"
        help: "Power draw on the phase in Volts-Amperes-Reactive"
        labels:
          phase: "L1"
        address: 300030
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_load_var"
        help: "Power draw on the phase in Volts-Amperes-Reactive"
        labels:
          phase: "L2"
        address: 300032
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_load_var"
        help: "Power draw on the phase in Volts-Amperes-Reactive"
        labels:
          phase: "L3"
        address: 300034
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_system_voltage_volts"
        help: "Average voltage between phase and neutral in this meter"
        labels:
          phase: "All"
          reference: "N"
        address: 300036
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_system_voltage_volts"
        help: "Average voltage between phases in this meter"
        labels:
          phase: "All"
          reference: "L"
        address: 300038
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_system_load_watts"
        help: "Power draw across the whole meter in Watts"
        address: 300040
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_system_load_va"
        help: "Power draw across the whole meter in Volts-Amperes"
        address: 300042
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_system_load_var"
        help: "Power draw across the whole meter in Volts-Amperes-Reactive"
        address: 300044
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_power_factor"
        help: "Power factor of the phase"
        labels:
          phase: "L1"
        address: 300046
        dataType: "int16"
        metricType: "gauge"
        factor: 0.001
      - name: "cagaemet_phase_power_factor"
        help: "Power factor of the phase"
        labels:
          phase: "L2"
        address: 300047
        dataType: "int16"
        metricType: "gauge"
        factor: 0.001
      - name: "cagaemet_phase_power_factor"
        help: "Power factor of the phase"
        labels:
          phase: "L3"
        address: 300048
        dataType: "int16"
        metricType: "gauge"
        factor: 0.001
      - name: "cagaemet_system_power_factor"
        help: "Power factor across the whole meter"
        address: 300049
        dataType: "int16"
        metricType: "gauge"
        factor: 0.001
      - name: "cagaemet_frequency_hertz"
        help: "Power frequency in Hertz"
        address: 300051
        dataType: "int16"
        metricType: "gauge"
        factor: 0.1
      - name: "cagaemet_consumed_kwh_total"
        help: "Total kwh consumed on this meter"
        address: 300052
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_consumed_kvarh_total"
        help: "Total kvarh consumed on this meter"
        address: 300054
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_load_dmd_watts"
        help: "Power draw DMD on the meter in Watts"
        address: 300056
        dataType: "int32"
        metricType: "gauge"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_load_dmd_peak_watts"
        help: "Peak power draw DMD on the meter in Watts"
        address: 300058
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_consumed_kwh_partial_total"
        help: "Total partial kwh consumed on this meter"
        address: 300060
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_consumed_kvarh_partial_total"
        help: "Total partial kvarh consumed on this meter"
        address: 300062
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_consumed_kwh_total"
        help: "Total kwh consumed on this phase"
        labels:
          phase: "L1"
        address: 300064
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_consumed_kwh_total"
        help: "Total kwh consumed on this phase"
        labels:
          phase: "L2"
        address: 300066
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_consumed_kwh_total"
        help: "Total kwh consumed on this phase"
        labels:
          phase: "L3"
        address: 300068
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_produced_kwh_total"
        help: "Total kwh produced on this meter"
        address: 300078
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_produced_kvarh_total"
        help: "Total kvarh produced on this meter"
        address: 300080
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_produced_kwh_total"
        help: "Total kwh produced on this phase"
        labels:
          phase: "L1"
        address: 300096
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_produced_kwh_total"
        help: "Total kwh produced on this phase"
        labels:
          phase: "L2"
        address: 300098
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_phase_produced_kwh_total"
        help: "Total kwh produced on this phase"
        labels:
          phase: "L3"
        address: 300100
        dataType: "int32"
        metricType: "counter"
        factor: 0.1
        endianness: "yolo"
      - name: "cagaemet_firmware_version"
        help: "The firmware version of this meter"
        address: 300770
        dataType: "uint16"
        metricType: "gauge"
      - name: "cagaemet_firmware_revision"
        help: "The firmware revision of this meter"
        address: 300771
        dataType: "uint16"
        metricType: "gauge"
      - name: "cagaemet_modbus_address"
        help: "The Modbus address for this meter (1-247)"
        address: 308192
        dataType: "uint16"
        metricType: "gauge"
  - name: "carlo_gavazzi_em_et_3xx_series_tcp"
    protocol: 'tcp/ip'
    timeout: 2000
    metrics: *cagaemet3xx-metrics
